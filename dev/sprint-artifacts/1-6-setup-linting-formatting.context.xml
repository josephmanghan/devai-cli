<story-context id=".bmad/bmm/workflows/4-implementation/story-context/template" v="1.0">
  <metadata>
    <epicId>1</epicId>
    <storyId>6</storyId>
    <title>setup-linting-formatting</title>
    <status>drafted</status>
    <generatedAt>2025-11-29</generatedAt>
    <generator>BMAD Story Context Workflow</generator>
    <sourceStoryPath>dev/sprint-artifacts/1-6-setup-linting-formatting.md</sourceStoryPath>
  </metadata>

  <story>
    <asA>developer</asA>
    <iWant>ESLint and Prettier configured with project-specific standards</iWant>
    <soThat>I can maintain consistent code quality and formatting across the codebase</soThat>
    <tasks>- Install ESLint and Prettier dependencies (AC: 1, 2)
  - [ ] Add eslint, prettier, @typescript-eslint/parser, @typescript-eslint/eslint-plugin
  - [ ] Add eslint-config-prettier to prevent conflicts
- [ ] Configure ESLint (AC: 1, 4)
  - [ ] Create .eslintrc.js with TypeScript configuration
  - [ ] Apply rules from dev/styleguides/clean-code.md (function size, naming, etc.)
- [ ] Configure Prettier (AC: 2, 4)
  - [ ] Create .prettierrc.js with project formatting standards
  - [ ] Set consistent tab width, quote style, trailing commas
- [ ] Add npm scripts (AC: 3)
  - [ ] Add lint, lint:fix, format, format:check scripts
  - [ ] Update package.json with new scripts
- [ ] Integrate with build process (AC: 5)
  - [ ] Add lint validation to build or pre-commit hook
  - [ ] Ensure CI pipeline will catch linting errors
- [ ] Add comprehensive validation command (AC: 3)
  - [ ] Create `npm run pr` script that runs all quality checks in sequence
  - [ ] Include format:check, lint, typecheck, test, and build in the validation pipeline</tasks>
  </story>

  <acceptanceCriteria>1. [ ] ESLint configured with TypeScript support and project-specific rules
2. [ ] Prettier configured with consistent formatting standards
3. [ ] npm scripts added for linting and formatting commands
4. [ ] Configuration follows project styleguide standards
5. [ ] Build process includes linting validation</acceptanceCriteria>

  <artifacts>
    <docs>
      <doc path="dev/styleguides/clean-code.md" title="Clean Code Standards" section="Functions &amp; Methods" snippet="Functions should be small, preferably under 15 lines. The ideal number of arguments is 0-2. Three or more arguments is a strong indicator they should be encapsulated into a single object."/>
      <doc path="dev/architecture.md" title="System Architecture" section="Development Dependencies" snippet="Linting/Formatting: ESLint + Prettier (configured per styleguide standards)"/>
      <doc path="dev/sprint-artifacts/1-5-setup-hexagonal-architecture-structure.md" title="Hexagonal Architecture Setup" section="Learnings from Previous Story" snippet="Configuration files don't need tests - only test actual business logic, not configuration"/>
    </docs>
    <code>
      <artifact path="package.json" kind="package-manifest" symbol="scripts" lines="12-26" reason="Contains existing format scripts and devDependencies including prettier"/>
      <artifact path="src" kind="directory" symbol="source-tree" reason="Target for linting rules - TypeScript strict mode project structure"/>
    </code>
    <dependencies>
      <ecosystem name="Node.js">
        <package name="prettier" version="^3.0.0" type="devDependency" present="true"/>
        <package name="eslint" version="latest" type="devDependency" present="false"/>
        <package name="@typescript-eslint/parser" version="latest" type="devDependency" present="false"/>
        <package name="@typescript-eslint/eslint-plugin" version="latest" type="devDependency" present="false"/>
        <package name="eslint-config-prettier" version="latest" type="devDependency" present="false"/>
        <package name="typescript" version="^5.9.3" type="devDependency" present="true"/>
      </ecosystem>
    </dependencies>
  </artifacts>

  <constraints>
    <constraint type="coding-standards" source="dev/styleguides/clean-code.md" severity="mandatory">
      Functions must be â‰¤15 lines, prefer 0-2 arguments maximum, use intention-revealing names
    </constraint>
    <constraint type="build-integration" source="dev/sprint-artifacts/1-2-configure-build-tooling-tsup.md" severity="mandatory">
      Linting must work with existing tsup build system and TypeScript strict mode
    </constraint>
    <constraint type="hexagonal-architecture" source="dev/sprint-artifacts/1-5-setup-hexagonal-architecture-structure.md" severity="mandatory">
      Linting rules must support hexagonal layer structure (core/, infrastructure/, features/, ui/)
    </constraint>
    <constraint type="testing-approach" source="dev/sprint-artifacts/1-3-setup-testing-framework-vitest.md" severity="mandatory">
      Configuration files don't need unit tests - only test actual business logic
    </constraint>
  </constraints>

  <interfaces>
    <interface name="ESLint Configuration" kind="file-config" signature=".eslintrc.js" path=".eslintrc.js" description="ESLint configuration with TypeScript parser and project rules"/>
    <interface name="Prettier Configuration" kind="file-config" signature=".prettierrc.js" path=".prettierrc.js" description="Prettier formatting configuration with project standards"/>
  </interfaces>

  <tests>
    <standards>Configuration files (ESLint/Prettier configs) are setup tooling and do not require unit tests. Focus on testing that linting rules work correctly on existing source code. Use Vitest for any logic tests that may be needed.</standards>
    <locations>src/ directory for linting rule validation. Configuration files (.eslintrc.js, .prettierrc.js) in project root.</locations>
    <ideas>
      <test idea="Validate linting rules on existing TypeScript files" mapsTo="AC:1,4"/>
      <test idea="Test format scripts run without errors" mapsTo="AC:3"/>
      <test idea="Verify build process includes linting validation" mapsTo="AC:5"/>
      <test idea="Validate pr command runs all validation steps: format:check, lint, typecheck, test, build" mapsTo="AC:3"/>
    </ideas>
  </tests>
</story-context>